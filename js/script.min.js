$(document).ready(function(){var a=!1,e=$("#dataKind").val(),t=$("#PurchaseForm").find('input[name="_token"]').val(),n="",r=($(document).find('input[name="baseUrl"]').val(),{topup:"شارژ مستقیم",pin:"کارت شارژ",internetpackage:"بسته اینترنت",antivirus:"آنتی ویروس",giftcard:"گیفت کارت"}),d={MTN:"ایرانسل",MCI:"همراه اول",RTL:"رایتل","MTN!":"شگفت انگیز ایرانسل"};$(".sidebar").find('a[data-kind="'+e+'"]').addClass("active"),$("nav.menu_mobile").find('a[data-kind="'+e+'"]').addClass("active"),$(document).on("click",'*[data-name="SelectValue"]',function(){var t=$(this).data("target-input"),n=$(this).data("value");if($(document).find('a[data-name="'+t+'"]').find("span").html($(this).data("title")),$("#PurchaseForm #data"+t).val(n),"SimType"==t)switch(e){case"internetpackage":$(document).find('a[data-name="PackageId"]').find("span").html("انتخاب بسته اینترنت"),$("#PurchaseForm #dataPackageId").val(""),a=!1;break;case"topup":"MTN!"!=n&&"MTN"!=n?($(document).find("#SpecialCharge").hide(),$(document).find("#SpecialCharge").find("input[type=checkbox]").prop("checked",!1)):"MTN!"==n?0==$(document).find("#SpecialCharge").find("input[type=checkbox]").is(":checked")&&$("#PurchaseForm #dataSimType").val("MTN"):"MTN"==n&&($(document).find("#SpecialCharge").show(),$(document).find("#SpecialCharge").find(".custom-radio").css("",""))}}),$(document).on("click",".select-items",function(){if(0!==$(this).parent().find(".list-filter-toggle").length){var a=$(this).parent().find(".list-filter-toggle").data("filter-key"),e=$(this).parent().find(".list-filter-toggle").data("parent-element"),t=$(this).parent().find(".list-filter-toggle").data("item-element"),n=$(document).find(e).data("active-filters");for(var r in n["data-"+a]=$(this).parent().find(".select-selected").html(),$(document).find(e).data("active-filters",n),$(document).find(e).find(t).show(),n)"همه"!=n[r]&&$(document).find(e).find(t+"["+r+"!='"+n[r]+"']").hide()}}),$(document).find('a[data-name="Amount"]').on("click",function(a){if(!["MTN","MCI","RTL","MTN!"].includes($("#PurchaseForm #dataSimType").val()))return swal("خطا","لطفا نوع سیمکارت را انتخاب کنید","error"),!1;$("#selectcharge").modal("show")}),$(document).find('a[data-name="ProductId"]').on("click",function(a){if(""===$("#PurchaseForm #dataProductCategory").val())return"giftcard"===e?swal("خطا","لطفا نوع گیفت کارت را انتخاب کنید.","error"):swal("خطا","لطفا نوع آنتی ویروس را انتخاب کنید.","error"),!1;var n;n={kind:e,category:$("#PurchaseForm #dataProductCategory").val()},$("#vmsLoading,#vmsLoadingBack").fadeIn(),$.ajax({type:"POST",url:"/getPurchaseProducts",headers:{"X-CSRF-TOKEN":t},data:n,async:!0,success:function(a){$("#vmsLoading,#vmsLoadingBack").fadeOut(),function(a){if("Error"==a.status)return swal("خطا","خطا در دریافت لیست محصولات","error"),!1;$("#ProductModal").find(".selectsimcart .list-inline").html(a.products),$("#ProductModal").modal("show")}(a)},error:function(a){$("#vmsLoading,#vmsLoadingBack").fadeOut(),swal("خطا","خطا در برقراری ارتباط با سرور.","error")}})}),$(document).find('a[data-name="PackageId"]').on("click",function(a){if(""===$("#PurchaseForm #dataSimType").val())return swal("خطا","لطفا نوع سیمکارت را انتخاب کنید","error"),!1;var e;e={simType:$("#PurchaseForm #dataSimType").val()},$("#vmsLoading,#vmsLoadingBack").fadeIn(),$.ajax({type:"POST",url:"/getInternetPackages",headers:{"X-CSRF-TOKEN":t},data:e,async:!0,success:function(a){$("#vmsLoading,#vmsLoadingBack").fadeOut(),function(a){if("Error"==a.status)return swal("خطا","خطا در دریافت لیست بسته های اینترنت.","error"),!1;$("#selectinternet").find(".modal-body").html(a.packages),$("#selectinternet").modal("show")}(a)},error:function(a){$("#vmsLoading,#vmsLoadingBack").fadeOut(),swal("خطا","خطا در برقراری ارتباط با سرور.","error")}})}),$(document).find('input[data-name="Cellphone"]').on("keyup",function(a){$("#PurchaseForm #dataCellphone").val($(this).val())}),setInterval(function(){switch(e){case"topup":""!==$("#PurchaseForm #dataSimType").val()&&""!==$("#PurchaseForm #dataAmount").val()&&($("#PurchaseTitle").html(r[e]+" "+d[$("#PurchaseForm #dataSimType").val()]+" "+$("#PurchaseForm #dataAmount").val()+" تومانی "),n="TopUp",a=!0);break;case"pin":""!==$("#PurchaseForm #dataSimType").val()&&""!==$("#PurchaseForm #dataAmount").val()&&""!==$("#PurchaseForm #dataCount").val()&&($("#PurchaseTitle").html($("#PurchaseForm #dataCount").val()+" عدد "+r[e]+" "+d[$("#PurchaseForm #dataSimType").val()]+" "+$("#PurchaseForm #dataAmount").val()+" تومانی "),n="BuyProduct",a=!0);break;case"giftcard":""!==$("#PurchaseForm #dataProductCategory").val()&&""!==$("#PurchaseForm #dataProductId").val()&&($("#PurchaseTitle").html($(document).find('a[data-name="ProductId"]').find("span").html()),n="BuyProduct",a=!0);case"antivirus":""!==$("#PurchaseForm #dataProductCategory").val()&&""!==$("#PurchaseForm #dataProductId").val()&&($("#PurchaseTitle").html($(document).find('a[data-name="ProductId"]').find("span").html()),n="BuyProduct",a=!0);break;case"internetpackage":""!==$("#PurchaseForm #dataSimType").val()&&""!==$("#PurchaseForm #dataPackageId").val()&&($("#PurchaseTitle").html($(document).find('a[data-name="PackageId"]').find("span").html()),$("#PurchaseTitle").html(r[e]+" "+d[$("#PurchaseForm #dataSimType").val()]+" "+$(document).find('a[data-name="PackageId"]').find("span").html()),n="InternetRecharge",a=!0)}if(a&&""!==$("#PurchaseForm #dataCellphone").val())return $("#SubmitPurchaseButton").removeClass("disabled"),!1;$("#SubmitPurchaseButton").addClass("disabled")},100),$("#SubmitPurchaseButton").on("click",function(){if(a){$("#vmsLoading,#vmsLoadingBack").fadeIn();var e=$("form#PurchaseForm").serialize()+"&action="+n;$.ajax({type:"POST",url:"/purchase",headers:{"X-CSRF-TOKEN":t},data:e,async:!0,success:function(a){"Error"===a.status?($("#vmsLoading,#vmsLoadingBack").fadeOut(),swal("خطا",a.errorMessage,"error")):window.location.href=a.url},error:function(a){$("#vmsLoading,#vmsLoadingBack").fadeOut(),swal("خطا","خطا در برقراری ارتباط با سرور.","error")}})}else swal("خطا","لطفا تمامی ورودی ها را پر کنید.","error")}),$(document).find('input[data-name="Cellphone"]').on("keyup",function(a){13==a.keyCode&&$("#SubmitPurchaseButton").trigger("click")}),$(document).find('input[data-name="Cellphone"]').on("input",function(){var a;$(this).val().length>$(this).attr("maxLength")&&$(this).val($(this).val().slice(0,$(this).attr("maxLength"))),$(this).val((a=$(this).val(),a.replace(/[۰-۹]/g,function(a){return["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"].indexOf(a)})).replace(/[^\d\.\-]/g,""))})});